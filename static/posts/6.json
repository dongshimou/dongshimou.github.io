{"title":"记一次煞笔行为","author":"skadi","date":"2017-05-26 17:00","tags":["qt","qtchart","f**k"],"content":"<hr />\n<p><a href=\"#update1\" target=\"_blank\">2017/05/26 20:00</a>更新</p>\n<hr />\n<h3 id=\"fuckqtchart\">fuck qtchart!!!</h3>\n<p>写得<code>radarChart</code>继承于<code>QChartView</code></p>\n<p>然后f**k的事情来了.各种设置背景色失败.</p>\n<pre><code>m_viewer-&gt;setBackgroundBrush(Qt::red);\n</code></pre>\n<p>结果就是一个红色边框</p>\n<pre><code>m_viewer-&gt;chart()-&gt;setBackgroundBrush(Qt::red);\n</code></pre>\n<p>结果就是啥都没有</p>\n<p>最后,实在没法,新建了一个demo,直接挨个套.\nf**k的事情出现了,设置背景成功了…\n一模一样的代码…</p>\n<p>最后,我在自己定义的<code>randarChart</code>内部调用了一次</p>\n<pre><code>chart()-&gt;setBackgroundBrush(Qt::red)\n</code></pre>\n<p>也行? WTF???</p>\n<p>最后我发现我在内部调用的时候是写在<code>setChart(xxx)</code>之后的.</p>\n<p>而外面调用时写在<code>setChart(xxx)</code>之前的.</p>\n<p>话说一个<code>QChartView</code>在没有<code>setChart()</code>之前调用<code>Chart()</code>来获取其<code>chart</code>难道不应该直接<code>assert(chart!=nullptr)</code>么?</p>\n<p>虽然我是自己傻逼造成的这个问题,qt难道不是加这么个一条来进行处理么?</p>\n<h3 id=\"update1\">update1</h3>\n<p>看了源码,结果发现在没有<code>setChart()</code>的时候默认是<code>new</code>的一个,在<code>setChart()</code>的时候,原来的会<code>memmove</code>,但是居然要求手动<code>release</code>!! WTF???</p>\n<blockquote>\n  <p>To avoid memory leaks users need to make sure the previous chart is deleted.</p>\n</blockquote>\n<p>WTF???</p>\n<p><a href=\"https://doc.qt.io/qt-5/qchartview.html#setChart\" target=\"_blank\">setChart</a>的文档,简直有点无法理解啊.</p>","iso8601Date":"2017-05-26T17:00:00+08:00","basename":"6","prev":"7","next":"5"}