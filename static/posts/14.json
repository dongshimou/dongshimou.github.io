{"title":"一个无边框的qt的顶级窗口","author":"skadi","date":"2017-09-15 13:38","tags":["cpp","qt","window"],"content":"<p>打算写个类似SAO风格的window,但是qt的顶级的window都有window窗口状态栏.\n使用<code>Qt::FramelessWindowHint</code>之后,鼠标事件之类的又没了.</p>\n<p>我只是希望有一个顶级窗口来作为容器.所以就自己写了一个.本来是有<code>QSizeGrip</code>\n可以</p>\n<p>来resize操作的,但是这样就有了一个右下角的瑕疵.所以还是自己重写了.</p>\n<p>override了这些函数:</p>\n<pre><code>void mousePressEvent(QMouseEvent *event)override;\nvoid mouseReleaseEvent(QMouseEvent *event)override;\nvoid mouseDoubleClickEvent(QMouseEvent *event)override;\nvoid mouseMoveEvent(QMouseEvent *event)override;\n</code></pre>\n<p>写完了一对比,不行啊.我要的圆角呢.这窗口没圆角啊.又不想直接使用windowsAPI.\n然后又继续魔改<code>content</code>窗口.</p>\n<pre><code>setAttribute(Qt::WA_TranslucentBackground);\n</code></pre>\n<p>设置顶级窗口透明,里面的<code>QWidget</code>再设置圆角<code>border-radius: 20px;</code>.\n不过遇到一个很迷的事情.<code>content</code></p>\n<p>窗口的child是一个<code>QWidget</code>,如果不在这个widget的构造函数里面给他设置background,居然就直接全透了.</p>\n<p><code>content</code>和它的child都透.而且,即使设置了<code>this-&gt;setObjectName(\"window\");</code>.在app.qss里面写</p>\n<pre><code>QWidget#window{\nbackground:transparent;\n}\n</code></pre>\n<p>也不顶用.必须在构造函数里写.本来不想这样写的.每次<code>setStyleSheet</code>都很慢.</p>\n<p>o(︶︿︶)o 唉</p>\n<pre><code>explicit content(QWidget* child=nullptr)noexcept;\n\n//如果要给一个login窗口\n//创建一个顶级窗口的容器的话.\n\nclass login{\n    content* ct;\n    //other code\n    login(){\n        ct=new content{this};\n        this-&gt;setObjectName(\"login\");\n        this-&gt;setStyleSheet(\"QWidget#login{\"\n                            \"background:transparent;\"\n                            \"}\"\n        );\n    }\n}\n\n//这个窗口就没有了状态栏\n//再给它设置`border-radius: 20px;`\n//那么它就有了圆角\n</code></pre>\n<p><img src=\"https://user-images.githubusercontent.com/9100799/30468681-2af80828-9a1f-11e7-8928-386397cd2a06.png\" alt=\"window\" /></p>\n<p>如图的qss如下</p>\n<pre><code>login{\n    background:#057FBA;\n    border-radius: 20px;\n    border: 5px solid #837F83;\n}\n</code></pre>\n<p>相关源码在这里</p>\n<p><a href=\"https://github.com/dongshimou/pp/blob/master/src/content.cpp\">content.cpp</a>\n<a href=\"https://github.com/dongshimou/pp/blob/master/src/content.h\">content.h</a></p>\n<p><a href=\"https://github.com/dongshimou/pp/blob/master/src/window.cpp\">window.cpp</a>\n<a href=\"https://github.com/dongshimou/pp/blob/master/src/window.h\">window.h</a></p>","iso8601Date":"2017-09-15T13:38:00+08:00","basename":"14","prev":"15","next":"13"}